(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-12b6532c"],{"1e9d":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",[a("el-col",{staticStyle:{height:"46px"},attrs:{span:24}},[a("el-form",{attrs:{inline:!0,model:t.filters},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"名称"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getApiList(e)}},model:{value:t.filters.name,callback:function(e){t.$set(t.filters,"name","string"===typeof e?e.trim():e)},expression:"filters.name"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.getApiList}},[t._v("查询")])],1),a("el-form-item",[a("router-link",{staticStyle:{"text-decoration":"none",color:"aliceblue"},attrs:{to:{name:"新增接口",params:{project_id:this.$route.params.project_id}}}},[a("el-button",{attrs:{type:"primary"}},[t._v("新增")])],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",disabled:t.update},on:{click:t.changeGroup}},[t._v("修改分组")])],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:t.api,"highlight-current-row":""},on:{"selection-change":t.selsChange}},[a("el-table-column",{attrs:{type:"selection","min-width":"5%"}}),a("el-table-column",{attrs:{prop:"name",label:"接口名称","min-width":"17%",sortable:"","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-icon",{attrs:{name:"name"}}),a("router-link",{staticStyle:{"text-decoration":"none"},attrs:{to:{name:"基础信息",params:{api_id:e.row.id}}}},[t._v(t._s(e.row.name))])]}}])}),a("el-table-column",{attrs:{prop:"requestType",label:"请求方式","min-width":"11%",sortable:"","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"apiAddress",label:"接口地址","min-width":"19%",sortable:"","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"userUpdate",label:"最近更新者","min-width":"13%",sortable:"","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"lastUpdateTime",label:"更新日期","min-width":"15%",sortable:"","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"Mock","min-width":"7%"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.mockStatus?a("el-button",{attrs:{type:"success",size:"small"},on:{click:function(a){return t.checkMockStatus(e.row)}}},[t._v("关闭")]):t._e(),e.row.mockStatus?t._e():a("el-button",{attrs:{type:"info",size:"small"},on:{click:function(a){return t.checkMockStatus(e.row)}}},[t._v("启动")])]}}])}),a("el-table-column",{attrs:{label:"操作","min-width":"13%"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){return t.handleDel(e.$index,e.row)}}},[t._v("删除")]),a("router-link",{staticStyle:{"text-decoration":"none",color:"aliceblue"},attrs:{to:{name:"修改",params:{api_id:e.row.id}}}},[a("el-button",{attrs:{type:"info",size:"small"}},[t._v("修改")])],1)]}}])})],1),a("el-dialog",{staticStyle:{width:"60%",left:"20%"},attrs:{title:"修改所属分组",visible:t.updateGroupFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.updateGroupFormVisible=e}}},[a("el-form",{ref:"updateGroupForm",attrs:{model:t.updateGroupForm,"label-width":"80px",rules:t.updateGroupFormRules}},[a("el-form-item",{attrs:{label:"分组名称",prop:"firstGroup"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.updateGroupForm.firstGroup,callback:function(e){t.$set(t.updateGroupForm,"firstGroup",e)},expression:"updateGroupForm.firstGroup"}},t._l(t.group,(function(t,e){return a("el-option",{key:e+"",attrs:{label:t.name,value:t.id}})})),1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(e){t.updateGroupFormVisible=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary",loading:t.updateGroupLoading},nativeOn:{click:function(e){return t.updateGroupSubmit(e)}}},[t._v("提交")])],1)],1),a("el-col",{staticClass:"toolbar",attrs:{span:24}},[a("el-button",{attrs:{type:"danger",disabled:0===this.sels.length},on:{click:t.batchRemove}},[t._v("批量删除")]),a("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"prev, pager, next","page-size":20,"page-count":t.total},on:{"current-change":t.handleCurrentChange}})],1)],1)},s=[],r=a("2d92"),i=a("1157"),n=a.n(i),l={data(){return{filters:{name:""},api:[],total:0,page:1,listLoading:!1,sels:[],updateGroupFormVisible:!1,updateGroupForm:{firstGroup:""},updateGroupFormRules:{firstGroup:[{type:"number",required:!0,message:"请选择分组",trigger:"blur"}]},group:[],updateGroupLoading:!1,update:!0}},methods:{checkMockStatus(t){let e=this,a=JSON.stringify({project_id:Number(this.$route.params.project_id),id:Number(t.id)});n.a.ajax({type:"post",url:r["ub"]+"/api/api/updateMock",async:!0,data:a,headers:{Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))},timeout:5e3,success:function(t){e.listLoading=!1,"0"===t.code?(e.$message.success({message:t.msg,center:!0}),e.getApiList()):e.$message.error({message:t.msg,center:!0})}})},getApiList(){this.listLoading=!0;let t=this,e={project_id:this.$route.params.project_id,page:t.page};this.$route.params.firstGroup&&(e["apiGroupLevelFirst_id"]=this.$route.params.firstGroup),n.a.ajax({type:"get",url:r["ub"]+"/api/api/api_list",async:!0,data:e,headers:{Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))},timeout:5e3,success:function(e){t.listLoading=!1,"0"===e.code?(t.total=e.data.total,t.api=e.data.data):t.$message.error({message:e.msg,center:!0})}})},updateGroupSubmit(){let t=this.sels.map(t=>t.id),e=this;this.$confirm("确认修改所属分组吗？","提示",{type:"warning"}).then(()=>{e.updateGroupLoading=!0;let a=JSON.stringify({project_id:Number(this.$route.params.project_id),apiGroupLevelFirst_id:Number(e.updateGroupForm.firstGroup),ids:t});n.a.ajax({type:"post",url:r["ub"]+"/api/api/update_group",async:!0,data:a,headers:{"Content-Type":"application/json",Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))},timeout:5e3,success:function(t){e.updateGroupLoading=!1,"0"===t.code?(e.$message({message:"修改成功",center:!0,type:"success"}),e.$router.push({name:"分组接口列表",params:{project_id:e.$route.params.project_id,firstGroup:e.updateGroupForm.firstGroup}})):e.$message.error({message:t.msg,center:!0}),e.updateGroupFormVisible=!1,e.getApiList()}})}).catch(()=>{})},getApiGroup(){let t=this;n.a.ajax({type:"get",url:r["ub"]+"/api/api/group",async:!0,data:{project_id:this.$route.params.project_id},headers:{Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))},timeout:5e3,success:function(e){"0"===e.code?(t.group=e.data,t.updateGroupForm.firstGroup=t.group[0].id):t.$message.error({message:e.msg,center:!0})}})},changeGroup(){this.getApiGroup(),this.updateGroupFormVisible=!0},handleDel:function(t,e){this.$confirm("确认删除该记录吗?","提示",{type:"warning"}).then(()=>{this.listLoading=!0;let t=this;n.a.ajax({type:"post",url:r["ub"]+"/api/api/del_api",async:!0,data:JSON.stringify({project_id:Number(this.$route.params.project_id),ids:[e.id]}),headers:{"Content-Type":"application/json",Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))},timeout:5e3,success:function(e){"0"===e.code?t.$message({message:"删除成功",center:!0,type:"success"}):t.$message.error({message:e.msg,center:!0}),t.getApiList()}})}).catch(()=>{})},handleCurrentChange(t){this.page=t,this.getApiList()},selsChange:function(t){t.length>0?(this.sels=t,this.update=!1):this.update=!0},batchRemove:function(){let t=this.sels.map(t=>t.id),e=this;this.$confirm("确认删除选中记录吗？","提示",{type:"warning"}).then(()=>{e.listLoading=!0,n.a.ajax({type:"post",url:r["ub"]+"/api/api/del_api",async:!0,data:JSON.stringify({project_id:Number(this.$route.params.project_id),ids:t}),headers:{"Content-Type":"application/json",Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))},timeout:5e3,success:function(t){e.listLoading=!1,"0"===t.code?e.$message({message:"删除成功",center:!0,type:"success"}):e.$message.error({message:t.msg,center:!0}),e.getApiList()}})}).catch(()=>{})}},mounted(){this.getApiList()},watch:{$route:function(t,e){t!==e&&this.getApiList()}}},p=l,u=(a("3286"),a("2877")),c=Object(u["a"])(p,o,s,!1,null,"69ee7e82",null);e["default"]=c.exports},3286:function(t,e,a){"use strict";var o=a("a918"),s=a.n(o);s.a},a918:function(t,e,a){}}]);